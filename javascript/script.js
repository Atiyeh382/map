
var map = L.map('map').setView([51.505, -0.09], 13);
L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19,
    attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
}).addTo(map);
const marker= L.marker([35.6892, 51.3890]).addTo(map)
  .bindPopup("Tehran, Iran")
  .openPopup();

var Polygon1 = {

    "type":"FeatureCollection", "features": [
        {
          "type": "Feature",
          "geometry": {
            "type": "Polygon",
            "coordinates": [[[51.38192686062848, 35.65547429438588], [51.38330178923954, 35.65268129544291], [51.3901764322948, 35.648957144926406], [51.3901764322948, 35.6476536512269], [51.39223882521138, 35.64672257127717], [51.392697134748396, 35.64616391809878], [51.39613445627603, 35.64783986591471], [51.39842600396111, 35.64914335657583], [51.404842337479366, 35.648957144926406], [51.422028945117525, 35.646908788135214], [51.43875724321866, 35.64523282078731], [51.442194564746295, 35.64523282078731], [51.4449444219684, 35.64523282078731], [51.44884005303305, 35.64560526101402], [51.449756672107085, 35.64597769950457], [51.45731877946787, 35.64523282078731], [51.461672720069544, 35.64411548969032], [51.46373511298612, 35.64467415719197], [51.46258933914358, 35.648957144926406], [51.46098525576402, 35.653984707103945], [51.46144356530104, 35.65715004687015], [51.461672720069544, 35.6608738153901], [51.46258933914358, 35.66310799315199], [51.46419342252314, 35.66571445486259], [51.46533919636568, 35.66869316405184], [51.46442257729164, 35.67185792078412], [51.46144356530104, 35.67371948377818], [51.458922862847444, 35.67725633384861], [51.45983948192147, 35.68097916458409], [51.460297791458494, 35.68432956374285], [51.45869370807893, 35.68674920897006], [51.457089624699364, 35.68842430498291], [51.45731877946787, 35.691402166598046], [51.456173005625324, 35.6923327255536], [51.457089624699364, 35.69791585128653], [51.45754793423638, 35.701637717956615], [51.45777708900489, 35.70387075456857], [51.45777708900489, 35.708336640157114], [51.45686046993085, 35.713732584769666], [51.460297791458494, 35.71894211568559], [51.467630744050766, 35.72266300067938], [51.473588768032, 35.72601164859792], [51.47656778002261, 35.72861605521801], [51.48027211468507, 35.73260194963863], [51.48236603207193, 35.73511105051561], [51.482665163127194, 35.736406039392044], [51.484061108051776, 35.74012901510068], [51.484061108051776, 35.74296159739402], [51.48346284594124, 35.74474202610876], [51.48376197699651, 35.74789814278416], [51.484659370162305, 35.751054134317584], [51.485357342624596, 35.75291530142896], [51.485357342624596, 35.75599017781415], [51.485157921921086, 35.75736574194006], [51.484659370162305, 35.75890310899804], [51.481867480313156, 35.75955041255658], [51.47907559046401, 35.75938858716066], [51.47498746604204, 35.75825580017315], [51.47209586584113, 35.756961166724516], [51.46990223810252, 35.75688025143455], [51.466303308136204, 35.75708807349754], [51.45979539608495, 35.75650127336927], [51.45376955159305, 35.75493645187072], [51.4491899097792, 35.752589161924355], [51.44629750442309, 35.75121987748171], [51.440271659931184, 35.75082864902801], [51.43834338969377, 35.750241802741456], [51.42677376826932, 35.749068097186885], [51.42195309267579, 35.74926371598129], [51.41857861976033, 35.751024263495246], [51.41665034952292, 35.75200232861949], [51.415204146844864, 35.75219794020191], [51.41231174148876, 35.75200232861949], [51.405562795657815, 35.751611104012206], [51.39881384982689, 35.75141549098736], [51.38796732974146, 35.751024263495246], [51.3865211270634, 35.74867685815571], [51.38386975548696, 35.74300367609406], [51.383146654147936, 35.74006911292842], [51.383146654147936, 35.737721384515986], [51.383146654147936, 35.73459097228383], [51.383146654147936, 35.730677783939214], [51.381941485249556, 35.7253946746802], [51.37929011367312, 35.72187240717366], [51.37856701233409, 35.719524142320964], [51.37760287721539, 35.713457471120684], [51.37760287721539, 35.70249715245302], [51.37896106792547, 35.69230270704934], [51.38026249884952, 35.68052414247036], [51.38010526832931, 35.68065185786378], [51.382156015396994, 35.66348035003454], [51.382385170165506, 35.6608738153901], [51.38192686062848, 35.65845338560401], [51.38192686062848, 35.65547429438588]]]
          },
          "properties": null
        }
        ]
}
const pol1=L.geoJSON(Polygon1 );
pol1.addTo(map)


var Polygon2={
    "type":"FeatureCollection", "features": [
        {
          "type": "Feature",
          "geometry": {
            "type": "Polygon",
            "coordinates": [[[51.438922187028524, 35.66034619035955], [51.445075196444435, 35.661003917095265], [51.44657692031216, 35.67885422336201], [51.44704939414382, 35.68727538322809], [51.44725637913294, 35.68950288807265], [51.447489237245705, 35.68983910981594], [51.44720463288566, 35.690238371295365], [51.447903207223945, 35.698412285413006], [51.448084319089425, 35.70143789205446], [51.44725637913294, 35.701774063483214], [51.438174912735235, 35.69908465236608], [51.43791618149883, 35.698769481062726], [51.43747633839695, 35.69870644665258], [51.43711411466598, 35.69895858399422], [51.4370623684187, 35.69927375455013], [51.43765745026243, 35.70030330301798], [51.43843364397163, 35.70196315928901], [51.438951106444435, 35.70330782764064], [51.438174912735235, 35.70355995043177], [51.438252532106155, 35.703875102799465], [51.43902872581535, 35.70377005214865], [51.43977904640092, 35.70505166063144], [51.43843364397163, 35.7052617584171], [51.438951106444435, 35.70673242741304], [51.43341425798543, 35.70650132408188], [51.435820458483974, 35.709799735438025], [51.44050349386286, 35.717467489097345], [51.43915809143357, 35.71795063790668], [51.43944269579361, 35.7192950365675], [51.439882538895496, 35.72057639542784], [51.44094333696475, 35.723916233957645], [51.43724348028421, 35.72456738113475], [51.429947259417666, 35.72431532479431], [51.42870534948295, 35.724336329519815], [51.41261226657872, 35.723748195112464], [51.410200701669396, 35.723666588493536], [51.4095555718402, 35.72294207299518], [51.40896420283011, 35.72212152941389], [51.408878185519555, 35.72174617155421], [51.408598614913444, 35.72101286375677], [51.406200730032225, 35.720192248168225], [51.40605019017422, 35.720008917998754], [51.40583513323419, 35.7198692375865], [51.405469536436165, 35.7197644771166], [51.4048136127691, 35.71958114596286], [51.40387811508001, 35.71929305329757], [51.39822211755748, 35.717354948293256], [51.39217901754291, 35.71520726336368], [51.389329513087624, 35.71415959117424], [51.389738121273666, 35.71099029895388], [51.390125223765686, 35.70800423891502], [51.3902219993887, 35.707759761209125], [51.39088867590276, 35.70762879070109], [51.39120050846578, 35.70758513381726], [51.391576858110824, 35.706930277690674], [51.39285644690392, 35.70394406555726], [51.393297313630974, 35.7029748323118], [51.393652157582004, 35.70213656702976], [51.39423281132005, 35.70091408102826], [51.39201772483785, 35.700931545245965], [51.39116824992477, 35.70056479587079], [51.39168438658082, 35.69677495354935], [51.39231880455388, 35.691858368977186], [51.39249085010587, 35.691124785081314], [51.39278117697489, 35.690827856348164], [51.392727412739895, 35.6905658594892], [51.392684401351886, 35.69054839300133], [51.39254461434087, 35.690469793758616], [51.39258762572887, 35.69011172956171], [51.392727412739895, 35.68851352098717], [51.39315752661993, 35.68819038202854], [51.39307150384392, 35.687902175906984], [51.3929424696799, 35.687727505023524], [51.392931716832905, 35.68762270230986], [51.393514584473785, 35.68322411664098], [51.39392131199886, 35.680106224696885], [51.39425813323053, 35.67720503038757], [51.39418187181957, 35.67689012572726], [51.394417011170006, 35.676322261723634], [51.3945123379337, 35.675769881043145], [51.39452504816885, 35.67574923122395], [51.394582244227074, 35.675558220143046], [51.394823738695095, 35.67542399586675], [51.395020747340055, 35.67529493384974], [51.3949444859291, 35.67521749653935], [51.39496355128184, 35.67527428390764], [51.39484767819432, 35.67508602809261], [51.39461593201924, 35.67456832231162], [51.395166329184974, 35.67074425514552], [51.39557629768158, 35.66781826938335], [51.39614304140853, 35.6673066800453], [51.396080069883304, 35.66666718876238], [51.3956707549694, 35.666436970646515], [51.39630047022157, 35.66139758558467], [51.39740247191285, 35.6597603565049], [51.39813115490812, 35.6596359973884], [51.39861676243336, 35.65918883561055], [51.409203006483665, 35.65808407224803], [51.4124727638203, 35.65842602444581], [51.41273175450042, 35.658715367469505], [51.430407868419266, 35.6597675150818], [51.43118484045966, 35.65960969382371], [51.43134670963474, 35.65974121156045], [51.433224392065675, 35.659688604491755], [51.43539343901176, 35.6596359973884], [51.438922187028524, 35.66034619035955]]]
          },
          "properties": null
        }
        ]

}
const pol2=L.geoJSON(Polygon2,{
    color: 'red',        // outline color
    weight: 3,           // outline thickness
    fillColor: '#f53', // inside fill color
    fillOpacity: 0.1

})
pol2.addTo(map)
// ], {
//     color: 'red',        // outline color
//     weight: 3,           // outline thickness
//     fillColor: '#f53', // inside fill color
//     fillOpacity: 0.5 }
// ).addTo(map);
var qom_shp;
async function load_shp(){
  const geojson= await shp("qomm.zip") ;
  qom_shp = L.geoJSON(geojson, {
    style: {
      color: "green",
      weight: 2,
      fillColor: "green",
      fillOpacity: 0.1
    }
  }).addTo(map);
}


const markers=L.layerGroup();
for (let i = 0; i < 100; i++) {
    let lat = 25 + (Math.random() * (40 - 25));  
    let lon = 44 + (Math.random() * (63 - 44)); 
  
    L.circleMarker([lat, lon], {
      radius: 5,
      color: "green",
      fillColor: "lime",
      fillOpacity: 0.8
    }).addTo(markers)

 }
markers.addTo(map)

load_shp().then(() => {
  var overlays = {
    "Polygon1": pol1,
    "Polygon2":pol2,
    "qom_shp":qom_shp,
    "markers":markers,
    "Tehran marker":marker,
 

  
  }
  L.control.layers(null, overlays,).addTo(map);
});

var coordsControl = L.control({ position: "bottomright" });

coordsControl.onAdd = function (map) {
  this._div = L.DomUtil.create("div", "leaflet-control coords-control");
  this.update();
  return this._div;
};

coordsControl.update = function (latlng) {
  this._div.innerHTML = latlng
    ? "Lat: " + latlng.lat.toFixed(5) + "<br>Lon: " + latlng.lng.toFixed(5)
    : "Move mouse over map";
};

coordsControl.addTo(map);

// update on mouse move
map.on("mousemove", function (e) {
  coordsControl.update(e.latlng);
});

